	.text
	.p2align	5
	.globl	_ECRYPT_keystream_bytes
	.globl	ECRYPT_keystream_bytes
_ECRYPT_keystream_bytes:
ECRYPT_keystream_bytes:
	pushq	%rbp
	pushq	%rdi
	pushq	%rsi
	pushq	%rbx
	pushq	%r12
	subq	$240, %rsp
	movq	%rdi, %rax
	movq	%rsi, %r12
	movq	%r12, %rsi
	movq	%rdx, %rbp
	cmpq	$0, %rbp
	jbe 	L1
	movq	$0, %rcx
	movq	$0, %rdx
	movq	%rsi, (%rsp)
	jmp 	L6
L7:
	movq	%rcx, (%rsi)
	movq	%rcx, 8(%rsi)
	movq	%rcx, 16(%rsi)
	movq	%rcx, 24(%rsi)
	movq	%rcx, 32(%rsi)
	movq	%rcx, 40(%rsi)
	movq	%rcx, 48(%rsi)
	movq	%rcx, 56(%rsi)
	addq	$64, %rsi
	addq	$64, %rdx
L6:
	cmpq	%rbp, %rdx
	jb  	L7
	movq	(%rsp), %rbx
	movq	(%rax), %rcx
	movq	8(%rax), %rdx
	movq	16(%rax), %rsi
	movq	24(%rax), %rdi
	movq	32(%rax), %r8
	movq	40(%rax), %r9
	movq	48(%rax), %r10
	movq	56(%rax), %r11
	movq	%rcx, (%rsp)
	movq	%rdx, 8(%rsp)
	movq	%rsi, 16(%rsp)
	movq	%rdi, 24(%rsp)
	movq	%r8, 232(%rsp)
	movq	%r9, 32(%rsp)
	movq	%r10, 40(%rsp)
	movq	%r11, 48(%rsp)
	movq	%rax, 56(%rsp)
	jmp 	L2
L3:
	movq	%rbx, 64(%rsp)
	movq	%r12, 72(%rsp)
	movq	%rbp, 80(%rsp)
	movq	(%rsp), %rax
	movq	8(%rsp), %rcx
	movq	16(%rsp), %rdx
	movq	24(%rsp), %rsi
	movq	232(%rsp), %rdi
	movq	32(%rsp), %r8
	movq	40(%rsp), %r9
	movq	48(%rsp), %r10
	movq	%rax, 88(%rsp)
	movq	%rcx, 96(%rsp)
	movq	%rdx, 104(%rsp)
	movq	%rsi, 112(%rsp)
	movq	%rdi, 120(%rsp)
	movq	%r8, 128(%rsp)
	movq	%r9, 136(%rsp)
	movq	%r10, 200(%rsp)
	shrq	$32, %rax
	shrq	$32, %rcx
	shrq	$32, %rdx
	shrq	$32, %rsi
	shrq	$32, %rdi
	shrq	$32, %r8
	shrq	$32, %r9
	shrq	$32, %r10
	movq	%rax, 216(%rsp)
	movq	%rcx, 224(%rsp)
	movq	%rdx, 144(%rsp)
	movq	%rsi, 152(%rsp)
	movq	%rdi, 160(%rsp)
	movq	%r8, 168(%rsp)
	movq	%r9, 176(%rsp)
	movq	%r10, 184(%rsp)
	movq	$20, %rax
	jmp 	L4
L5:
	subq	$2, %rax
	movq	136(%rsp), %rdi
	movq	88(%rsp), %r8
	movq	104(%rsp), %rdx
	movq	%rdi, %rcx
	addq	%r8, %rcx
	rol	$7, %ecx
	xorq	%rcx, %rdx
	movq	%rdx, 104(%rsp)
	movq	120(%rsp), %rsi
	movq	%r8, %rcx
	addq	%rdx, %rcx
	rol	$9, %ecx
	xorq	%rcx, %rsi
	movq	%rsi, 120(%rsp)
	addq	%rsi, %rdx
	rol	$13, %edx
	xorq	%rdx, %rdi
	movq	%rdi, 136(%rsp)
	addq	%rsi, %rdi
	rol	$18, %edi
	xorq	%rdi, %r8
	movq	%r8, 88(%rsp)
	movq	216(%rsp), %rdi
	movq	144(%rsp), %r8
	movq	160(%rsp), %rdx
	movq	%rdi, %rcx
	addq	%r8, %rcx
	rol	$7, %ecx
	xorq	%rcx, %rdx
	movq	%rdx, 160(%rsp)
	movq	176(%rsp), %rsi
	movq	%r8, %rcx
	addq	%rdx, %rcx
	rol	$9, %ecx
	xorq	%rcx, %rsi
	movq	%rsi, 176(%rsp)
	addq	%rsi, %rdx
	rol	$13, %edx
	xorq	%rdx, %rdi
	movq	%rdi, 144(%rsp)
	addq	%rsi, %rdi
	rol	$18, %edi
	xorq	%rdi, %r8
	movq	%r8, 192(%rsp)
	movq	112(%rsp), %rdi
	movq	128(%rsp), %r8
	movq	200(%rsp), %rdx
	movq	%rdi, %rcx
	addq	%r8, %rcx
	rol	$7, %ecx
	xorq	%rcx, %rdx
	movq	%rdx, 200(%rsp)
	movq	96(%rsp), %rsi
	movq	%r8, %rcx
	addq	%rdx, %rcx
	rol	$9, %ecx
	xorq	%rcx, %rsi
	movq	%rsi, 96(%rsp)
	addq	%rsi, %rdx
	rol	$13, %edx
	xorq	%rdx, %rdi
	movq	%rdi, 112(%rsp)
	addq	%rsi, %rdi
	rol	$18, %edi
	xorq	%rdi, %r8
	movq	%r8, 128(%rsp)
	movq	168(%rsp), %rdi
	movq	184(%rsp), %r8
	movq	224(%rsp), %rdx
	movq	%rdi, %rcx
	addq	%r8, %rcx
	rol	$7, %ecx
	xorq	%rcx, %rdx
	movq	%rdx, 168(%rsp)
	movq	152(%rsp), %rsi
	movq	%r8, %rcx
	addq	%rdx, %rcx
	rol	$9, %ecx
	xorq	%rcx, %rsi
	movq	%rsi, 152(%rsp)
	addq	%rsi, %rdx
	rol	$13, %edx
	xorq	%rdx, %rdi
	movq	%rdi, 184(%rsp)
	addq	%rsi, %rdi
	rol	$18, %edi
	xorq	%rdi, %r8
	movq	%r8, 208(%rsp)
	movq	168(%rsp), %rdi
	movq	88(%rsp), %r8
	movq	144(%rsp), %rdx
	movq	%rdi, %rcx
	addq	%r8, %rcx
	rol	$7, %ecx
	xorq	%rcx, %rdx
	movq	%rdx, 216(%rsp)
	movq	96(%rsp), %rsi
	movq	%r8, %rcx
	addq	%rdx, %rcx
	rol	$9, %ecx
	xorq	%rcx, %rsi
	movq	%rsi, 96(%rsp)
	addq	%rsi, %rdx
	rol	$13, %edx
	xorq	%rdx, %rdi
	movq	%rdi, 224(%rsp)
	addq	%rsi, %rdi
	rol	$18, %edi
	xorq	%rdi, %r8
	movq	%r8, 88(%rsp)
	movq	104(%rsp), %rdi
	movq	192(%rsp), %r8
	movq	112(%rsp), %rdx
	movq	%rdi, %rcx
	addq	%r8, %rcx
	rol	$7, %ecx
	xorq	%rcx, %rdx
	movq	%rdx, 112(%rsp)
	movq	152(%rsp), %rsi
	movq	%r8, %rcx
	addq	%rdx, %rcx
	rol	$9, %ecx
	xorq	%rcx, %rsi
	movq	%rsi, 152(%rsp)
	addq	%rsi, %rdx
	rol	$13, %edx
	xorq	%rdx, %rdi
	movq	%rdi, 104(%rsp)
	addq	%rsi, %rdi
	rol	$18, %edi
	xorq	%rdi, %r8
	movq	%r8, 144(%rsp)
	movq	160(%rsp), %rdi
	movq	128(%rsp), %r8
	movq	184(%rsp), %rdx
	movq	%rdi, %rcx
	addq	%r8, %rcx
	rol	$7, %ecx
	xorq	%rcx, %rdx
	movq	%rdx, 168(%rsp)
	movq	120(%rsp), %rsi
	movq	%r8, %rcx
	addq	%rdx, %rcx
	rol	$9, %ecx
	xorq	%rcx, %rsi
	movq	%rsi, 120(%rsp)
	addq	%rsi, %rdx
	rol	$13, %edx
	xorq	%rdx, %rdi
	movq	%rdi, 160(%rsp)
	addq	%rsi, %rdi
	rol	$18, %edi
	xorq	%rdi, %r8
	movq	%r8, 128(%rsp)
	movq	200(%rsp), %rdi
	movq	208(%rsp), %r8
	movq	136(%rsp), %rdx
	movq	%rdi, %rcx
	addq	%r8, %rcx
	rol	$7, %ecx
	xorq	%rcx, %rdx
	movq	%rdx, 136(%rsp)
	movq	176(%rsp), %rsi
	movq	%r8, %rcx
	addq	%rdx, %rcx
	rol	$9, %ecx
	xorq	%rcx, %rsi
	movq	%rsi, 176(%rsp)
	addq	%rsi, %rdx
	rol	$13, %edx
	xorq	%rdx, %rdi
	movq	%rdi, 200(%rsp)
	addq	%rsi, %rdi
	rol	$18, %edi
	xorq	%rdi, %r8
	movq	%r8, 184(%rsp)
L4:
	cmpq	$0, %rax
	jnbe	L5
	movq	64(%rsp), %rbx
	movq	72(%rsp), %r12
	movq	(%rsp), %rcx
	movq	%rcx, %rax
	shrq	$32, %rax
	addl	88(%rsp), %ecx
	addl	216(%rsp), %eax
	shlq	$32, %rax
	xorq	%rcx, %rax
	xorq	(%r12), %rax
	movq	%rax, (%rbx)
	movq	8(%rsp), %rcx
	movq	%rcx, %rax
	shrq	$32, %rax
	addl	96(%rsp), %ecx
	addl	224(%rsp), %eax
	shlq	$32, %rax
	xorq	%rcx, %rax
	xorq	8(%r12), %rax
	movq	%rax, 8(%rbx)
	movq	16(%rsp), %rcx
	movq	%rcx, %rax
	shrq	$32, %rax
	addl	104(%rsp), %ecx
	addl	144(%rsp), %eax
	shlq	$32, %rax
	xorq	%rcx, %rax
	xorq	16(%r12), %rax
	movq	%rax, 16(%rbx)
	movq	24(%rsp), %rcx
	movq	%rcx, %rax
	shrq	$32, %rax
	addl	112(%rsp), %ecx
	addl	152(%rsp), %eax
	shlq	$32, %rax
	xorq	%rcx, %rax
	xorq	24(%r12), %rax
	movq	%rax, 24(%rbx)
	movq	232(%rsp), %rcx
	movq	%rcx, %rax
	shrq	$32, %rax
	addl	120(%rsp), %ecx
	addl	160(%rsp), %eax
	shlq	$32, %rax
	xorq	%rcx, %rax
	xorq	32(%r12), %rax
	movq	%rax, 32(%rbx)
	movq	32(%rsp), %rcx
	movq	%rcx, %rax
	shrq	$32, %rax
	addl	128(%rsp), %ecx
	addl	168(%rsp), %eax
	shlq	$32, %rax
	xorq	%rcx, %rax
	xorq	40(%r12), %rax
	movq	%rax, 40(%rbx)
	movq	40(%rsp), %rcx
	movq	%rcx, %rax
	shrq	$32, %rax
	addl	136(%rsp), %ecx
	addl	176(%rsp), %eax
	shlq	$32, %rax
	xorq	%rcx, %rax
	xorq	48(%r12), %rax
	movq	%rax, 48(%rbx)
	movq	48(%rsp), %rcx
	movq	%rcx, %rax
	shrq	$32, %rax
	addl	200(%rsp), %ecx
	addl	184(%rsp), %eax
	shlq	$32, %rax
	xorq	%rcx, %rax
	xorq	56(%r12), %rax
	movq	%rax, 56(%rbx)
	movq	80(%rsp), %rbp
	movq	232(%rsp), %rax
	incq	%rax
	movq	%rax, 232(%rsp)
	subq	$64, %rbp
	addq	$64, %rbx
	addq	$64, %r12
L2:
	cmpq	$0, %rbp
	jnbe	L3
	movq	56(%rsp), %rax
	movq	232(%rsp), %rcx
	movq	%rcx, 32(%rax)
L1:
	addq	$240, %rsp
	popq	%r12
	popq	%rbx
	popq	%rsi
	popq	%rdi
	popq	%rbp
	ret 
